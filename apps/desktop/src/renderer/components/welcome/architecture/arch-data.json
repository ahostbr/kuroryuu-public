{
  "components": [
    {
      "id": "desktop",
      "label": "Desktop App",
      "x": 0.4,
      "y": 0.03,
      "w": 0.2,
      "h": 0.11,
      "title": "Desktop App (Electron)",
      "bodyMd": "**What you're seeing:** The Kuroryuu desktop application.\n\n**Why it matters:** Your command center for all AI operations.\n\n• React + Electron frontend\n• Multi-pane workspace\n• Real-time updates via IPC\n• Offline-capable",
      "jumpRoute": "welcome",
      "color": "#c9a227",
      "icon": "monitor"
    },
    {
      "id": "cliproxyapi",
      "label": "CLIProxyAPI",
      "x": 0.08,
      "y": 0.20,
      "w": 0.18,
      "h": 0.11,
      "title": "CLIProxyAPI (Multi-Provider Proxy)",
      "bodyMd": "**What you're seeing:** Unified API for 9 AI providers.\n\n**Why it matters:** One interface for all models.\n\n• 61 models: Claude, OpenAI, Gemini, Copilot, Kiro\n• OpenAI-compatible API on port 8317\n• OAuth per provider, tokens stored locally\n• Auto-fallback between providers",
      "jumpRoute": "welcome",
      "color": "#22c55e",
      "icon": "cpu"
    },
    {
      "id": "gateway",
      "label": "Gateway",
      "x": 0.33,
      "y": 0.20,
      "w": 0.18,
      "h": 0.11,
      "title": "Gateway (FastAPI)",
      "bodyMd": "**What you're seeing:** FastAPI gateway service.\n\n**Why it matters:** Single entry point with auth and routing.\n\n• Single-user auth (hackathon POC)\n• Routes requests to MCP_CORE\n• WebSocket support for streaming\n• Local-first design",
      "jumpRoute": "traffic-flow",
      "color": "#3b82f6",
      "icon": "server"
    },
    {
      "id": "mcp_core",
      "label": "MCP_CORE",
      "x": 0.58,
      "y": 0.20,
      "w": 0.18,
      "h": 0.11,
      "title": "MCP_CORE (Tool Registry)",
      "bodyMd": "**What you're seeing:** MCP Core (port 8100).\n\n**Why it matters:** Central hub for 118 tool actions.\n\n• 16 routed tools: k_rag, k_pty, k_files, k_session...\n• Permission management per tool\n• Tool routing and dispatch\n• Connects to PTY Daemon, Gateway, Persistence",
      "jumpRoute": "traffic-flow",
      "color": "#8b5cf6",
      "icon": "box"
    },
    {
      "id": "providers",
      "label": "Providers",
      "x": 0.02,
      "y": 0.40,
      "w": 0.16,
      "h": 0.11,
      "title": "LLM Providers",
      "bodyMd": "**What you're seeing:** Multi-provider routing.\n\n**Why it matters:** Use any model seamlessly.\n\n• CLIProxyAPI (default): 61 models, 9 providers\n• LMStudio: Local models on GPU\n• Direct Claude API with OAuth\n• Automatic fallback chain",
      "color": "#10b981",
      "icon": "cpu"
    },
    {
      "id": "leader_worker",
      "label": "Leader/Worker",
      "x": 0.21,
      "y": 0.40,
      "w": 0.16,
      "h": 0.11,
      "title": "Leader/Worker Orchestration",
      "bodyMd": "**What you're seeing:** Multi-agent orchestration system.\n\n**Why it matters:** Parallel AI execution with real-time coordination.\n\n• Leader coordinates overall task execution and delegates\n• Workers execute specific subtasks in isolated PTYs\n• Inbox message passing (k_inbox) for task delegation\n• Workers report progress to leader, operate in parallel\n• Leader makes architectural decisions, workers execute",
      "jumpRoute": "terminals",
      "color": "#f59e0b",
      "icon": "users"
    },
    {
      "id": "ralph",
      "label": "Ralph",
      "x": 0.40,
      "y": 0.40,
      "w": 0.16,
      "h": 0.11,
      "title": "Ralph (Autonomous Orchestrator)",
      "bodyMd": "**What you're seeing:** Ralph autonomous orchestrator.\n\n**Why it matters:** 100+ hour autonomous task execution.\n\n• 3-strike escalation system for handling failures\n• Automatic recovery from stuck states\n• Promise-based signals: DONE, STUCK, PROGRESS:%\n• Leader monitors worker via k_pty term_read\n• Desktop silence detection triggers nudges\n• Bootstrap files: @ralph_prime.md, @ralph_loop.md",
      "jumpRoute": "terminals",
      "color": "#f97316",
      "icon": "users"
    },
    {
      "id": "pty",
      "label": "PTY Daemon",
      "x": 0.59,
      "y": 0.40,
      "w": 0.16,
      "h": 0.11,
      "title": "PTY Daemon (Terminals)",
      "bodyMd": "**What you're seeing:** PTY Daemon (port 7072, JSON-RPC).\n\n**Why it matters:** Real shell access for AI agents.\n\n• 100KB ring buffer per terminal (late-join support)\n• Sentinel-based execution for reliable command completion\n• 11 actions: create, send_line, read, talk, term_read, resolve\n• Agent mesh: read/write each other's terminals in real-time\n• Delta mode for incremental output streaming\n• Dangerous command blocking and secret redaction",
      "jumpRoute": "terminals",
      "color": "#ec4899",
      "icon": "terminal"
    },
    {
      "id": "pccontrol",
      "label": "PC Control",
      "x": 0.78,
      "y": 0.40,
      "w": 0.16,
      "h": 0.11,
      "title": "k_pccontrol (Desktop Automation)",
      "bodyMd": "**What you're seeing:** Full Windows desktop access.\n\n**Why it matters:** Agents can interact with your PC.\n\n• Click, type, keypress actions\n• Launch apps, get window list\n• Opt-in via Settings → Integrations\n• All actions audit-logged",
      "jumpRoute": "welcome",
      "color": "#a855f7",
      "icon": "monitor"
    },
    {
      "id": "persistence",
      "label": "Persistence",
      "x": 0.25,
      "y": 0.60,
      "w": 0.18,
      "h": 0.11,
      "title": "Persistence Layer",
      "bodyMd": "**What you're seeing:** Checkpoint and state persistence.\n\n**Why it matters:** Never lose your work.\n\n• Checkpoints save session state, terminal configs, agent bindings\n• PTY persistence with atomic writes (temp + rename)\n• 7-day TTL cleanup, session resurrection on restart\n• Cross-references: plan_file, worklog_files, task_ids\n• 100KB buffer persistence per terminal",
      "color": "#6366f1",
      "icon": "database"
    },
    {
      "id": "observability",
      "label": "Observability",
      "x": 0.50,
      "y": 0.60,
      "w": 0.18,
      "h": 0.11,
      "title": "Observability (Traffic/Capture)",
      "bodyMd": "**What you're seeing:** Traffic monitoring and screen capture.\n\n**Why it matters:** Full visibility into AI operations.\n\n• HTTP Traffic: request/response logging, token counting, cost tracking\n• PTY Traffic: ReactFlow network graph visualization\n• Screen Capture (k_capture): start, stop, screenshot, digest\n• Visual Digest: periodic AI analysis of screen content\n• Claude Tasks Monitor: donut chart + Gantt timeline",
      "jumpRoute": "capture",
      "color": "#ef4444",
      "icon": "activity"
    }
  ],
  "edges": [
    { "from": "desktop", "to": "gateway", "label": "HTTP/WS" },
    { "from": "desktop", "to": "cliproxyapi", "label": "API" },
    { "from": "gateway", "to": "mcp_core", "label": "Route" },
    { "from": "cliproxyapi", "to": "providers", "label": "LLM calls" },
    { "from": "mcp_core", "to": "providers", "label": "LLM calls" },
    { "from": "mcp_core", "to": "leader_worker", "label": "Orchestrate" },
    { "from": "leader_worker", "to": "ralph", "label": "Autonomous" },
    { "from": "ralph", "to": "pty", "label": "k_pty" },
    { "from": "leader_worker", "to": "pty", "label": "Shell" },
    { "from": "mcp_core", "to": "pccontrol", "label": "Automation" },
    { "from": "mcp_core", "to": "persistence", "label": "State" },
    { "from": "mcp_core", "to": "observability", "label": "Metrics" }
  ],
  "suggestedPaths": [
    {
      "id": "start",
      "label": "Start Here",
      "components": ["desktop"]
    },
    {
      "id": "request-flow",
      "label": "Follow Request Flow",
      "components": ["desktop", "gateway", "mcp_core", "providers"]
    },
    {
      "id": "multi-provider",
      "label": "Multi-Provider Flow",
      "components": ["desktop", "cliproxyapi", "providers"]
    },
    {
      "id": "autonomous",
      "label": "Autonomous Execution",
      "components": ["leader_worker", "ralph", "pty"]
    },
    {
      "id": "security",
      "label": "Security Boundaries",
      "components": ["gateway", "persistence"]
    }
  ]
}
